Representación Textual del archivo de Excel: "Filtros Catálogo.xlsm"
Fecha y hora de generación: 29/07/2016 09:43:06 p.m.

Resumen
=======
 * Hojas: 1
 * Nombres Definidos: 20
 * Módulos de Visual Basic: 4
 * Líneas de código VB: 105

Detalle
=======

Hojas:
 [Catálogo]

Contenido:
[Catálogo]
Bloques: 18

@ A1 [1x1]
> Captura

@ A3 [1x2]
> TIPO
(SELECCION_TIPO) > N
 DataValidation: Lista. [Fuente:"=OFFSET(METACAT,0,0,,1)" ListaEnCelda:True ]
 Mensaje=[Mostrar:True Titulo:"" Mensaje:"" ] 
 Advertencia=[Mostrar:True Titulo:"" Mensaje:"" Estilo:Grave ] 
 OmitirBlancos:True DatoActualEsVálido:True 


@ A5 [1x2]
> MARCA
(SELECCION_MARCA) > Baic
 DataValidation: Lista. [Fuente:"=OFFSET(DESTINO_MARCAS,1,0,CONTEO_MARCAS,1)" ListaEnCelda:True ]
 Mensaje=[Mostrar:True Titulo:"" Mensaje:"" ] 
 Advertencia=[Mostrar:True Titulo:"" Mensaje:"" Estilo:Grave ] 
 OmitirBlancos:True DatoActualEsVálido:True 


@ A7 [1x2]
> AUTO
(SELECCION_AUTO) > Mameid
 DataValidation: Lista. [Fuente:"=OFFSET(DESTINO_AUTOS,1,1,CONTEO_AUTOS,1)" ListaEnCelda:True ]
 Mensaje=[Mostrar:True Titulo:"" Mensaje:"" ] 
 Advertencia=[Mostrar:True Titulo:"" Mensaje:"" Estilo:Grave ] 
 OmitirBlancos:True DatoActualEsVálido:True 


@ A10 [1x1]
> Catálogos

@ J10 [1x1]
> Zona de Búsquedas

@ Q10 [1x1]
> Meta Catálogo

@ A12 [1x1]
> Catálogo N

@ E12 [1x1]
> Catálogo S

@ J12 [1x1]
> Marcas

@ L12 [1x1]
> Autos

@ A14 [10x3]
(HEADER_MARCA) > MARCA
> Honda
> Honda
> Nissan
> Nissan
> Honda
> Toyota
> Baic
> Honda
> Honda
> AUTO
> Accord
> Civic
> Sentra
> Ventra
> Mamalón
> TuHoyota
> Mameid
> Fit
> Civic
> DATO
> a
> b
> c
> d
> e
> g
> --
> x
> b

@ E14 [7x4]
> Brand
> Hummer
> Hummer
> Ford
> Ford
> Chevrolet
> Chevrolet
> Carro
> H3
> H2
> Ka
> Exploter
> Spank
> Chevy
> Campo
> 8.81063830658396
> 7.26757075058705
> 1.17157911971267
> 4.03875095145369
> 6.13038631666927
> 6.21706932805607
> Traviesa
> 6.30113621112
> 4.33891429727652
> 4.98945367454637
> 3.33697476316045
> 6.10761154948007
> 7.30097305044152

@ L17 [2x3]
(DESTINO_AUTOS) > MARCA
> Baic
> AUTO
> Mameid
> DATO
> --

@ J17 [5x1]
(DESTINO_MARCAS) > MARCA
> Baic
> Honda
> Nissan
> Toyota

@ Q13 [4x4]
(Metacat.Catálogo) > =SELECCION_TIPO
> Catálogo
> N
> S
(Metacat.Rango_Nombrado) > =VLOOKUP(Metacat.Catálogo,METACAT,COLUMN()-COLUMN(Metacat.Catálogo)+1,0)
> Rango Nombrado
> CATALOGO_N
> CATALOGO_S
(Metacat.Campo_Marca) > =VLOOKUP(Metacat.Catálogo,METACAT,COLUMN()-COLUMN(Metacat.Catálogo)+1,0)
> Campo Marca
> MARCA
> Brand
(Metacat.Campo_Auto) > =VLOOKUP(Metacat.Catálogo,METACAT,COLUMN()-COLUMN(Metacat.Catálogo)+1,0)
> Campo Auto
> AUTO
> Carro

@ L14 [2x2]
> =Metacat.Campo_Marca
> =SELECCION_MARCA
> Conteo
(CONTEO_AUTOS) > =COUNTA(M18:M1048576)

@ J14 [2x1]
> Conteo
(CONTEO_MARCAS) > =COUNTA(J18:J1048576)


Nombres:
 [Catálogo!_FilterDatabase] =Catálogo!$A$14:$C$23
 [CATALOGO_N] =Catálogo!$A$14:$C$23
 [CATALOGO_S] =Catálogo!$E$14:$H$20
 [CONDICION_MARCA] =Catálogo!$L$14:$L$15
 [CONTEO_AUTOS] =Catálogo!$M$15
 [CONTEO_MARCAS] =Catálogo!$J$15
 [Catálogo!Criteria] =Catálogo!$L$14:$L$15
 [DESTINO_AUTOS] =Catálogo!$L$17
 [DESTINO_MARCAS] =Catálogo!$J$17
 [Catálogo!Extract] =Catálogo!$L$17:$N$17
 [HEADER_MARCA] =Catálogo!$A$14
 [INPUT_CELLS] =Catálogo!$B$3,Catálogo!$B$5,Catálogo!$B$7
 [METACAT] =Catálogo!$Q$15:$T$16
 [Metacat.Campo_Auto] =Catálogo!$T$13
 [Metacat.Campo_Marca] =Catálogo!$S$13
 [Metacat.Catálogo] =Catálogo!$Q$13
 [Metacat.Rango_Nombrado] =Catálogo!$R$13
 [SELECCION_AUTO] =Catálogo!$B$7
 [SELECCION_MARCA] =Catálogo!$B$5
 [SELECCION_TIPO] =Catálogo!$B$3

Nombre del proyecto VB: [VBAProject]

Módulos VBA:
 [ThisWorkbook] Tipo: 100
 [Sheet1] Tipo: 100
 [Module1] Tipo: 1
 [Module2] Tipo: 1

Codigo:
[ThisWorkbook] 0 líneas de código.
///--- BEGINNING OF MODULE ---
\\\--- END OF MODULE ---

[Sheet1] 24 líneas de código.
///--- BEGINNING OF MODULE ---
Private Sub Worksheet_Change(ByVal Target As Range)
On Error GoTo ErrHan
    If Application.Intersect(Target, [INPUT_CELLS]) Is Nothing Then Exit Sub
    
    Debug.Print "Manejando cambio en " & Target.Name.Name & " a [" & Target.Value & "]"
        
    Debug.Print "Actualizando Marcas..." 'Actualiza las marcas
    ExtraerÚnicosPorColumna [Metacat.Rango_Nombrado], _
                            [Metacat.Campo_Marca], _
                            [Destino_Marcas]
    ValidarComboDV [SELECCION_MARCA]
    
    Debug.Print "Actualizando Autos..." 'Actualiza los autos
    ExtraerPorCriteria [Metacat.Rango_Nombrado], _
                       [Condicion_Marca], _
                       [DESTINO_AUTOS], _
                       [Metacat.Campo_Auto]
    ValidarComboDV [SELECCION_AUTO]
    
ErrHan:
    If Err.Number <> 0 Then _
        Debug.Print Err.Number & " - " & Err.Description
End Sub

\\\--- END OF MODULE ---

[Module1] 59 líneas de código.
///--- BEGINNING OF MODULE ---
'Lista única de Marcas
Sub ExtraerÚnicosPorColumna(NomRangoNombrado As String, NomColumna As String, RgDestino As Range)
    'Limpiamos resultados previos
    RgDestino.CurrentRegion.ClearContents

    'Determinamos la columna a extraer los valores únicos
    Dim rgHeader: Set rgHeader = Range(NomRangoNombrado).Rows(1).Find(NomColumna)
    
    Intersect(rgHeader.CurrentRegion, rgHeader.EntireColumn).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=[Destino_Marcas], Unique:=True, criteriaRange:=""
    
    OrdenarFilasPorNombreDeColumna RgDestino.CurrentRegion, NomColumna
End Sub

'Lista filtrada por una Marca particular
Sub ExtraerPorCriteria(NomRangoNombrado As String, RgCriteria As Range, RgDestino As Range, Optional NomColumnaOrdenar As String)
    'Limpiamos resultados previos
    RgDestino.CurrentRegion.ClearContents
    
    Range(NomRangoNombrado).AdvancedFilter Action:=xlFilterCopy, _
                                           criteriaRange:=RgCriteria, _
                                           CopyToRange:=RgDestino, _
                                           Unique:=True
    
    If NomColumnaOrdenar <> "" Then _
        OrdenarFilasPorNombreDeColumna RgDestino.CurrentRegion, NomColumnaOrdenar
End Sub

Sub OrdenarFilasPorNombreDeColumna(rgAOrdenar As Range, NomColumna As String)
    'Determinar la columna de ordenamiento
    Dim rgHeader: Set rgHeader = rgAOrdenar.Rows(1).Find(NomColumna)
        
    If rgHeader Is Nothing Then Exit Sub 'No existe la columna? Nothing to do.
    
    'Determinar el Rango (Columna sin encabezado)
    Dim rgKey As Range
    Set rgKey = Intersect(rgHeader.EntireColumn, _
                          rgAOrdenar, _
                          rgAOrdenar.Offset(1, 0))
    
    If rgKey Is Nothing Then Exit Sub 'No hay filas?
    
    With rgAOrdenar.Parent.Sort
        .SortFields.Clear
        
        .SortFields.Add Key:=rgKey, _
                        SortOn:=xlSortOnValues, _
                        Order:=xlAscending, _
                        DataOption:=xlSortNormal
                             
        .SetRange rgAOrdenar
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
End Sub

\\\--- END OF MODULE ---

[Module2] 22 líneas de código.
///--- BEGINNING OF MODULE ---
Option Explicit

'Si la selección de la celda no es válida, seleccionar la primera disponible.
Sub ValidarComboDV(AValidar As Range)
    
    Debug.Print "Validando " & AValidar.Name.Name & " [" & AValidar.Value & "]"
    
    If Not AValidar.Validation.Value Then
        
        On Error Resume Next 'Si no hay un rango válido, ocurre un error y el objeto 'Is Nothing'
        Dim rgOpcionesVálidas As Range: Set rgOpcionesVálidas = Range(AValidar.Validation.Formula1)
        On Error GoTo 0
        
        Dim NewValue: NewValue = ""
        If Not rgOpcionesVálidas Is Nothing Then _
            NewValue = rgOpcionesVálidas.Cells(1)
        Debug.Print "...No Válido. Asignado [" & NewValue & "]"
        AValidar.Value = NewValue
    Else
        Debug.Print "...Válido"
    End If
End Sub
\\\--- END OF MODULE ---


** Fin del proceso de exportación. Proceso realizado en 0.00 minutos. **
ExportToTxt [ExportToTxt.xls] v3.0.0-SNAPSHOT (Standalone)
