Representación Textual del archivo de Excel: "Filtros Catálogo.xlsm"
Fecha y hora de generación: 29/07/2016 07:38:43 p.m.

Resumen
=======
 * Hojas: 1
 * Nombres Definidos: 19
 * Módulos de Visual Basic: 4
 * Líneas de código VB: 68

Detalle
=======

Hojas:
 [Catálogo]

Contenido:
[Catálogo]
Bloques: 17

@ A1 [1x1]
> Captura

@ A3 [1x2]
> TIPO
(SELECCION_TIPO) > N
 DataValidation: Lista. [Fuente:"=OFFSET(METACAT,0,0,,1)" ListaEnCelda:True ]
 Mensaje=[Mostrar:True Titulo:"" Mensaje:"" ] 
 Advertencia=[Mostrar:True Titulo:"" Mensaje:"" Estilo:Grave ] 
 OmitirBlancos:True DatoActualEsVálido:True 


@ A5 [1x1]
> MARCA

@ A7 [1x1]
> AUTO

@ A10 [1x1]
> Catálogos

@ J10 [1x1]
> Zona de Búsquedas

@ P10 [1x1]
> Meta Catálogo

@ A12 [1x1]
> Catálogo N

@ E12 [1x1]
> Catálogo S

@ J12 [1x1]
> Marcas

@ L12 [1x1]
> Autos

@ A14 [10x3]
(HEADER_MARCA) > MARCA
> Honda
> Honda
> Nissan
> Nissan
> Honda
> Toyota
> Baic
> Honda
> Honda
> AUTO
> Accord
> Civic
> Sentra
> Ventra
> Mamalón
> TuHoyota
> Mameid
> Fit
> Civic
> DATO
> a
> b
> c
> d
> e
> g
> --
> x
> b

@ E14 [7x4]
> Brand
> Hummer
> Hummer
> Ford
> Ford
> Chevrolet
> Chevrolet
> Carro
> H2
> H3
> Exploter
> KaKa
> Chevy
> Spank
> Campo
> 8.81063830658396
> 7.26757075058705
> 1.17157911971267
> 4.03875095145369
> 6.13038631666927
> 6.21706932805607
> Traviesa
> 6.30113621112
> 4.33891429727652
> 4.98945367454637
> 3.33697476316045
> 6.10761154948007
> 7.30097305044152

@ J17 [5x1]
(DESTINO_MARCAS) > MARCA
> Baic
> Honda
> Nissan
> Toyota

@ P13 [4x4]
(Metacat.Catálogo) > =SELECCION_TIPO
> Catálogo
> N
> S
(Metacat.Campo_Marca) > =VLOOKUP(Metacat.Catálogo,METACAT,COLUMN()-COLUMN(Metacat.Catálogo)+1,0)
> Campo Marca
> MARCA
> Brand
(Metacat.Campo_Auto) > =VLOOKUP(Metacat.Catálogo,METACAT,COLUMN()-COLUMN(Metacat.Catálogo)+1,0)
> Campo Auto
> AUTO
> Carro
(Metacat.Rango_Nombrado) > =VLOOKUP(Metacat.Catálogo,METACAT,COLUMN()-COLUMN(Metacat.Catálogo)+1,0)
> Rango Nombrado
> CATALOGO_N
> CATALOGO_S

@ L14 [2x2]
> =Metacat.Campo_Marca
> =SELECCION_MARCA
> Conteo
(CONTEO_AUTOS) > =COUNTA(M18:M1048576)

@ J14 [2x1]
> Conteo
(CONTEO_MARCAS) > =COUNTA(J18:J1048576)


Nombres:
 [Catálogo!_FilterDatabase] =Catálogo!$A$14:$A$23
 [CATALOGO_N] =Catálogo!$A$14:$C$23
 [CATALOGO_S] =Catálogo!$E$14:$H$20
 [CONDICION_MARCA] =Catálogo!$L$14:$L$15
 [CONTEO_AUTOS] =Catálogo!$M$15
 [CONTEO_MARCAS] =Catálogo!$J$15
 [DESTINO_AUTOS] =Catálogo!$L$17
 [DESTINO_MARCAS] =Catálogo!$J$17
 [Catálogo!Extract] =Catálogo!$J$17
 [HEADER_MARCA] =Catálogo!$A$14
 [INPUT_CELLS] =Catálogo!$B$3,Catálogo!$B$5,Catálogo!$B$7
 [METACAT] =Catálogo!$P$15:$S$16
 [Metacat.Campo_Auto] =Catálogo!$R$13
 [Metacat.Campo_Marca] =Catálogo!$Q$13
 [Metacat.Catálogo] =Catálogo!$P$13
 [Metacat.Rango_Nombrado] =Catálogo!$S$13
 [SELECCION_AUTO] =Catálogo!$B$7
 [SELECCION_MARCA] =Catálogo!$B$5
 [SELECCION_TIPO] =Catálogo!$B$3

Nombre del proyecto VB: [VBAProject]

Módulos VBA:
 [ThisWorkbook] Tipo: 100
 [Sheet1] Tipo: 100
 [Module1] Tipo: 1
 [Module2] Tipo: 1

Codigo:
[ThisWorkbook] 0 líneas de código.
///--- BEGINNING OF MODULE ---
\\\--- END OF MODULE ---

[Sheet1] 7 líneas de código.
///--- BEGINNING OF MODULE ---
Private Sub Worksheet_Change(ByVal Target As Range)
    If Application.Intersect(Target, [INPUT_CELLS]) Is Nothing Then Exit Sub
    
    'Actualiza las marcas
    ExtraerÚnicosPorColumna [Metacat.Rango_Nombrado], [Metacat.Campo_Marca], [Destino_Marcas]
    
End Sub
\\\--- END OF MODULE ---

[Module1] 53 líneas de código.
///--- BEGINNING OF MODULE ---
'Lista única de Marcas
Sub ExtraerÚnicosPorColumna(NomRangoNombrado As String, NomColumna As String, RgDestino As Range)
    'Limpiamos resultados previos
    RgDestino.CurrentRegion.ClearContents

    'Determinamos la columna a extraer los valores únicos
    Dim rgHeader: Set rgHeader = Range(NomRangoNombrado).Rows(1).Find(NomColumna)
    
    Intersect(rgHeader.CurrentRegion, rgHeader.EntireColumn).AdvancedFilter Action:=xlFilterCopy, CopyToRange:=[Destino_Marcas], Unique:=True, criteriaRange:=""
    
    OrdenarFilasPorNombreDeColumna RgDestino.CurrentRegion, NomColumna
End Sub

'Lista filtrada por una Marca particular
Sub Actualizar_Autos()
    'Limpiamos resultados previos
    [Destino_Autos].CurrentRegion.ClearContents
    
    [CATALOGO].AdvancedFilter Action:=xlFilterCopy, criteriaRange:=[CONDICION_MARCA], CopyToRange:=[Destino_Autos], Unique:=True
    
    OrdenarFilasPorNombreDeColumna [Destino_Autos].CurrentRegion, "auto"
End Sub

Sub OrdenarFilasPorNombreDeColumna(rgAOrdenar As Range, NomColumna As String)
    'Determinar la columna de ordenamiento
    Dim rgHeader: Set rgHeader = rgAOrdenar.Rows(1).Find(NomColumna)
        
    If rgHeader Is Nothing Then Exit Sub 'No existe la columna? Nothing to do.
    
    'Determinar el Rango (Columna sin encabezado)
    Dim rgKey As Range
    Set rgKey = Intersect(rgHeader.EntireColumn, _
                          rgAOrdenar, _
                          rgAOrdenar.Offset(1, 0))
    
    With rgAOrdenar.Parent.Sort
        .SortFields.Clear
        
        .SortFields.Add Key:=rgKey, _
                        SortOn:=xlSortOnValues, _
                        Order:=xlAscending, _
                        DataOption:=xlSortNormal
                             
        .SetRange rgAOrdenar
        .Header = xlYes
        .MatchCase = False
        .Orientation = xlTopToBottom
        .SortMethod = xlPinYin
        .Apply
    End With
    
End Sub

\\\--- END OF MODULE ---

[Module2] 8 líneas de código.
///--- BEGINNING OF MODULE ---
Option Explicit



Sub Rig()
    OrdenarFilasPorNombreDeColumna [Destino_Autos].CurrentRegion, "auto"
End Sub

\\\--- END OF MODULE ---


** Fin del proceso de exportación. Proceso realizado en 0.00 minutos. **
ExportToTxt [ExportToTxt.xls] v3.0.0-SNAPSHOT (Standalone)
